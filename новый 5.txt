Метод calcSpeed вычисляет текущую скорость вращения двигателя на основе переданной мощности и крутящего момента, используя параметры моделирования, заданные в структуре Simulation.

Входным параметром метода является напряжение voltage, которое используется для вычисления тока i в статоре двигателя. Ток i вычисляется путем деления напряжения voltage на сопротивление обмотки статора двигателя s.nominal.statorResistance.

Далее, вычисляется ЭДС e, которая зависит от максимальной скорости вращения двигателя s.nominal.maxSpeed и постоянной ЭДС s.nominal.emConstant.

Затем, в цикле for, для каждого шага моделирования, происходит вычисление изменения скорости вращения двигателя dw путем использования формулы:

dw = (voltage - i*s.nominal.statorResistance - e) / s.nominal.statorInductance

где s.nominal.statorInductance - индуктивность статора двигателя.

Далее, вычисляется изменение скорости вращения двигателя w на текущем шаге моделирования, используя следующее выражение:

w = w + dw*t

где t - шаг моделирования.

Затем, на основе изменения скорости dw, вычисляется изменение тока i в статоре двигателя путем использования формулы:

i = i + (s.nominal.torqueConstant*dw)/s.nominal.statorInductance

где s.nominal.torqueConstant - постоянная крутящего момента двигателя.

Наконец, вычисляется новое значение ЭДС e на основе текущей скорости w и постоянной ЭДС s.nominal.emConstant:


e = w * s.nominal.emConstant

Метод calcSpeed использует множество параметров из структуры Simulation для выполнения расчетов, включая параметры двигателя, такие как s.nominal.statorResistance, s.nominal.statorInductance, s.nominal.emConstant и s.nominal.torqueConstant, а также параметры времени моделирования, такие как s.simtime.step и s.simtime.duration.

В результате выполнения метода calcSpeed, возвращается текущая скорость вращения двигателя в об/сек.